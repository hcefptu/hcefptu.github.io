---
title: GraphQL Introspection Vulnerable
date: 2026-01-28
categories: [ GraphQL, Web, CTF ]
tags: [ CTF, Web ]
author: HceFptu
description: Writeup of web vulnerable about GraphQL.
toc: true
comments: true
---

# GraphQL Introspection Vulnerable - VSL CTF 2026

## Challenge's name: mrGraph

### Mô tả challenge: 

```
The new intern got his first task at the company to build an API endpoint that would handle some kind of data operation.
Since his "way-too-aggressive" mentor gave him a two-day deadline, he vibe-coded the entire thing and pushed it directly to production.
He even accidentally slipped in the admin password and quickly tried to hide it, but it wasn't enough.
```

### Hướng giải:

## 1. Reconnaissance

Dựa vào tiêu đề và gợi ý của challenge này thì ta thấy đây có thể sẽ là 1 bài liên quan tới lỗ hổng của GraphQL, 1 ngôn ngữ truy vấn API.

![images](assets/img/1.png)
_Hình 1: Tổng quan web_

Ta sẽ có 1 trang web như này, trang web dùng để đăng các bài blog.
Vào phần community thì sẽ cho ta tìm kiếm những người dùng khác.

![images](assets/img/2.png)
_Hình 2: Phần tìm kiếm user_


Ở đây sẽ thử tìm user admin.

![images](assets/img/3.png)
_Hình 3: Search user admin_

Vì như ta dự đoán khi nay đây là bài liên quan tới graphQL thì ta sẽ kiểm tra phần network của F12 xem các gói tin của server gửi.

![images](assets/img/4.png)
_Hình 4: GraphQL trả về đối tượng_

Đúng như dự đoán thì ở đây ta thấy được endpoint có tên là grapql. Khác với REST 1 ngôn ngữ truy vấn API như graphQL thì thay vì mỗi user sẽ là 1 đường dẫn khác ví dụ: GET /api/user/1, GET /api/user/2, … hay là GET /api/user/1/posts để lấy thông tin các bài viết của user 1.

Còn graphQL thì chỉ có 1 api duy và cách để lấy thông tin user sẽ thông qua các câu lệnh truy vấn ở phần body. Ví dụ:

```
Query {
	User (id:1) {
	      Name
	      Posts {
	            Title
	            Date
           }
        }
    }
```

Sẽ truy vấn người dùng có id là 1 và sẽ tra cứu tên, cũng như các bài viết của họ bao gồm tiêu đề và ngày viết.

Khi sử dụng burpSuite để bắt gói tin.

![images](assets/img/6.png)
_Hình 5: Câu truy vấn graphQL_

Thì ta sẽ thấy nguyên đoạn truy vấn này. Giờ ta sẽ sử dụng 1 cái gọi là truy vấn nội tại ( Introspection Query ), để ta có thể biết được cấu trúc của hệ thống, biết được sẽ có những trường nào và chứa loại thông tin gì. 

Thông thường thì trong các production thì các chuyên gia bảo mật thường luôn khuyên hãy tắt introspection tránh việc truy vấn ra những dữ liệu nhạy cảm.

## 2. Introspection

Giờ ta sẽ sử dụng câu truy vấn.

![images](assets/img/7.png)
_Hình 6: Dò xem cấu trúc hệ thống_

Giờ ta biết có 5 trường, ta sẽ chỉ quan tâm tới user và post, giờ ta sẽ tiếp tục truy vấn để xem bên trong có những miền giá trị nào.

![images](assets/img/9.png)
_Hình 7: Dò cấu trúc của PostType_

## 3. Analyze

Từ PostType thì ta đã thấy có cái gọi là postPassword, bài viết gì mà lại có password nhỉ, giờ đọc lại gợi ý thì gợi ý bảo là dev intern đã che đậy password bằng cái gì đó nhưng có vẻ giấu không kĩ lắm nhỉ.

Giờ ta quay lại trang web và xem Response graphQL về các bài viết.

![images](assets/img/10.png)
_Hình 8: Web trả về các đặc tính của 1 bài post_

Giờ ta thấy web trả về các đặc điểm của post không đầy đủ hết các miền mà ta đã truy vấn ra ở trên. Còn thiếu miền postPassword, giờ ta sẽ thử dò của từng bài viết.

## 4. Exploit

Trong kết quả trả về chỉ có 3 id của 3 bài post. Ta sẽ thử lần lượt từng cái.

![images](assets/img/11.png)
_Hình 9: Kết quả id 1_

![images](assets/img/12.png)
_Hình 10: Kết quả id 2_

![images](assets/img/13.png)
_Hình 11: Kết quả id 3_

Sau khi đã truy vấn hết 3 id thì ta thấy miền postPassword đều trống nhưng còn 1 miền đáng chú ý nhất chính là miền isHidden. 

Ta thấy cả 3 đều có giá trị là false ở miền isHidden, vậy là còn các bài viết khác bị giấu, giờ ta sẽ thử vận may.

![images](assets/img/14.png)
_Hình 12: Kết quả id 4_

## 5. Flag

Và sau khi thử post id là 4 thì ta thấy hệ thống trả về 1 bài post bị ẩn được viết bởi admin và kèm theo đó chính là flag của bài này.

> {: .prompt-danger }
> **FLAG:** `VSL{y0u_r34lly_kn0w_4b0u7_6r4ph_d0n7_y4}`


Đáng ra cậu dev intern đó có thể config lại để ẩn và chặn quyền truy cập vào những bài post có miền isHidden: true.



